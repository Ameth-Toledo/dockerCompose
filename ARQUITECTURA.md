# ğŸ—ï¸ Arquitectura del Sistema - KarGaps

## Diagrama General de Microservicios
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ARQUITECTURA DE MICROSERVICIOS                    â”‚
â”‚                   Ameth de Jesus Mendez Toledo                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                           USUARIO FINAL
                                â”‚
                                â”‚ HTTP
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   NAVEGADOR WEB       â”‚
                    â”‚   Chrome/Firefox/etc  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ Puerto 3000
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CONTENEDOR: ameth-frontend-kargaps                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  FRONTEND - Angular 19                                      â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                â”‚ â”‚
â”‚  â”‚  â€¢ Framework: Angular 19                                    â”‚ â”‚
â”‚  â”‚  â€¢ Lenguaje: TypeScript                                     â”‚ â”‚
â”‚  â”‚  â€¢ Estilos: Tailwind CSS                                    â”‚ â”‚
â”‚  â”‚  â€¢ Servidor: serve                                          â”‚ â”‚
â”‚  â”‚  â€¢ Puerto: 3000                                             â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  Componentes:                                               â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ Header (con nombre de Ameth)                          â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ Hero                                                   â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ Card Gorras                                            â”‚ â”‚
â”‚  â”‚  â””â”€â”€ Card Playeras                                          â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  Servicios:                                                 â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ AuthService                                            â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ GorrasService                                          â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ PlayerasService                                        â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ UsersService                                           â”‚ â”‚
â”‚  â”‚  â””â”€â”€ CarritoService                                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ HTTP REST API
                            â”‚ http://backend:5000/api
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CONTENEDOR: ameth-backend-kargaps                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  BACKEND API - Node.js + Express                            â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚ â”‚
â”‚  â”‚  â€¢ Runtime: Node.js 20                                      â”‚ â”‚
â”‚  â”‚  â€¢ Framework: Express 5                                     â”‚ â”‚
â”‚  â”‚  â€¢ Lenguaje: TypeScript                                     â”‚ â”‚
â”‚  â”‚  â€¢ Arquitectura: Hexagonal (DDD)                            â”‚ â”‚
â”‚  â”‚  â€¢ Puerto: 5000                                             â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  Endpoints Principales:                                     â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚ â”‚
â”‚  â”‚  â”‚ /api/users/toledo    [GET]           â”‚ â† Endpoint       â”‚ â”‚
â”‚  â”‚  â”‚ Retorna: "Ameth de Jesus             â”‚   Personalizado  â”‚ â”‚
â”‚  â”‚  â”‚          Mendez Toledo"              â”‚                  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  MÃ³dulos (Arquitectura Hexagonal):                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â”‚
â”‚  â”‚  â”‚ USERS                                          â”‚        â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ Domain (Entities, Repository Interface)   â”‚        â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ Application (Use Cases)                   â”‚        â”‚ â”‚
â”‚  â”‚  â”‚ â””â”€â”€ Infrastructure                             â”‚        â”‚ â”‚
â”‚  â”‚  â”‚     â”œâ”€â”€ Controllers                            â”‚        â”‚ â”‚
â”‚  â”‚  â”‚     â”œâ”€â”€ Adapters (PostgreSQL)                 â”‚        â”‚ â”‚
â”‚  â”‚  â”‚     â””â”€â”€ Routes                                 â”‚        â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â”‚
â”‚  â”‚  â”‚ GORRAS                                         â”‚        â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ Domain                                     â”‚        â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ Application (CRUD Use Cases)              â”‚        â”‚ â”‚
â”‚  â”‚  â”‚ â””â”€â”€ Infrastructure                             â”‚        â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â”‚
â”‚  â”‚  â”‚ PLAYERAS                                       â”‚        â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ Domain                                     â”‚        â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ Application (CRUD Use Cases)              â”‚        â”‚ â”‚
â”‚  â”‚  â”‚ â””â”€â”€ Infrastructure                             â”‚        â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  Core:                                                      â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ Security (JWT, bcrypt, auth middleware)               â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ Database (PostgreSQL connection)                      â”‚ â”‚
â”‚  â”‚  â””â”€â”€ Cloudinary (Image upload)                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ SQL Queries
                            â”‚ postgresql://ameth_user:***@database:5432
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CONTENEDOR: ameth-database-kargaps                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  BASE DE DATOS - PostgreSQL 17 Alpine                      â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                 â”‚ â”‚
â”‚  â”‚  â€¢ Motor: PostgreSQL 17                                     â”‚ â”‚
â”‚  â”‚  â€¢ Base de Datos: kargaps_db                               â”‚ â”‚
â”‚  â”‚  â€¢ Usuario: ameth_user                                      â”‚ â”‚
â”‚  â”‚  â€¢ Puerto: 5432                                             â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  Tablas:                                                    â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚ â”‚
â”‚  â”‚  â”‚ roles                                â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ id (PK)                          â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ nombre                           â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â””â”€â”€ descripcion                      â”‚                  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚ â”‚
â”‚  â”‚  â”‚ usuarios                             â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ id (PK)                          â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ nombres                          â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ apellido_paterno                 â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ apellido_materno                 â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ email (UNIQUE)                   â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ password_hash                    â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ rol_id (FK â†’ roles)              â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â””â”€â”€ avatar                           â”‚                  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚ â”‚
â”‚  â”‚  â”‚ gorras                               â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ id (PK)                          â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ nombre                           â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ descripcion                      â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ precio                           â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ stock                            â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ color                            â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â””â”€â”€ imagen_url                       â”‚                  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚ â”‚
â”‚  â”‚  â”‚ playeras                             â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ id (PK)                          â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ nombre                           â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ descripcion                      â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ precio                           â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ stock                            â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ color                            â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ talla                            â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ tipo                             â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ material                         â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ â””â”€â”€ imagen_url                       â”‚                  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ Persistencia
                            â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚  VOLUMEN DOCKER           â”‚
                â”‚  ameth_kargaps_           â”‚
                â”‚  persistent_data          â”‚
                â”‚                           â”‚
                â”‚  /var/lib/postgresql/data â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        RED DOCKER                                â”‚
â”‚                     ameth-network (bridge)                       â”‚
â”‚                                                                   â”‚
â”‚  Permite la comunicaciÃ³n interna entre contenedores usando       â”‚
â”‚  nombres de servicio como DNS:                                   â”‚
â”‚  â€¢ frontend â†’ http://backend:5000                                â”‚
â”‚  â€¢ backend â†’ postgresql://database:5432                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Flujo de Datos Detallado
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FLUJO DE SOLICITUD HTTP                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. USUARIO hace clic en "Ver Gorras"
   â”‚
   â–¼
2. FRONTEND (Angular) â†’ Servicio HTTP
   â”‚  MÃ©todo: gorrasService.getAll()
   â”‚  URL: http://backend:5000/api/gorras
   â”‚
   â–¼
3. BACKEND recibe solicitud
   â”‚  Router â†’ /api/gorras
   â”‚  Controller â†’ GetAllGorrasController
   â”‚  Use Case â†’ GetAllGorrasUseCase
   â”‚
   â–¼
4. REPOSITORY (PatrÃ³n Adapter)
   â”‚  PostgreSQLAdapter â†’ Ejecuta Query
   â”‚  SQL: SELECT * FROM gorras;
   â”‚
   â–¼
5. DATABASE (PostgreSQL)
   â”‚  Ejecuta consulta
   â”‚  Lee datos del volumen persistente
   â”‚  Retorna filas
   â”‚
   â–¼
6. BACKEND procesa respuesta
   â”‚  Mapea datos a entidades
   â”‚  Serializa a JSON
   â”‚  Status: 200 OK
   â”‚
   â–¼
7. FRONTEND recibe JSON
   â”‚  Actualiza componente
   â”‚  Renderiza cards de gorras
   â”‚  Usuario ve productos
   â”‚
   âœ… FLUJO COMPLETADO
```

## Arquitectura Hexagonal (Backend)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ARQUITECTURA HEXAGONAL                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Controllers     â”‚ â† Capa de PresentaciÃ³n
                    â”‚  (HTTP Handlers)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    Use Cases      â”‚ â† Capa de AplicaciÃ³n
                    â”‚ (LÃ³gica Negocio)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚         DOMAIN              â”‚ â† NÃºcleo
                â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
                â”‚  â”‚  Entities (Gorra,  â”‚    â”‚
                â”‚  â”‚  Playera, User)     â”‚    â”‚
                â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
                â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
                â”‚  â”‚  Repository         â”‚    â”‚
                â”‚  â”‚  Interfaces         â”‚    â”‚
                â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    Adapters       â”‚ â† Capa de Infraestructura
                    â”‚  (PostgreSQL)     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Seguridad
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FLUJO DE AUTENTICACIÃ“N                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. Usuario envÃ­a credenciales
   POST /api/auth/login
   { "email": "user@example.com", "password": "****" }
   â”‚
   â–¼
2. Backend valida con bcrypt
   â€¢ Hash almacenado vs Password ingresada
   â€¢ bcrypt.compare(password, hash)
   â”‚
   â–¼
3. Si es vÃ¡lido, genera JWT
   â€¢ Payload: { userId, email, role }
   â€¢ Firma con SECRET_KEY
   â€¢ Expira en 24h
   â”‚
   â–¼
4. Frontend almacena token
   â€¢ LocalStorage/SessionStorage
   â€¢ Incluye en headers: Authorization: Bearer <token>
   â”‚
   â–¼
5. Requests posteriores
   â€¢ Backend valida JWT con middleware
   â€¢ Extrae userId del payload
   â€¢ Permite/Deniega acceso
```

## Persistencia de Datos
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PERSISTENCIA CON VOLÃšMENES                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Contenedor PostgreSQL
â”œâ”€â”€ /var/lib/postgresql/data  â† Directorio de datos
â”‚   â””â”€â”€ (archivos BD)
â”‚
â””â”€â”€ MONTADO EN â†’ Volumen Docker: ameth_kargaps_persistent_data

BENEFICIOS:
âœ… Datos persisten aunque se detenga/elimine el contenedor
âœ… Backup fÃ¡cil con `docker volume`
âœ… Compartible entre recreaciones del contenedor
âœ… Independiente del ciclo de vida del contenedor

COMPROBACIÃ“N:
$ docker-compose down        # Detiene y elimina contenedores
$ docker volume ls           # Volumen sigue existiendo
$ docker-compose up -d       # Levanta de nuevo
$ # Los datos siguen ahÃ­ âœ…
```

## Variables de Entorno
```yaml
Backend:
  DB_HOST: database           # Nombre del servicio en red Docker
  DB_PORT: 5432
  DB_NAME: kargaps_db         # âœ… Base de datos con nombre de Ameth
  DB_USER: ameth_user
  DB_PASSWORD: Ameth2005
  PORT: 5000
  NODE_ENV: production

Database:
  POSTGRES_DB: kargaps_db
  POSTGRES_USER: ameth_user
  POSTGRES_PASSWORD: Ameth2005

Frontend:
  API_URL: http://backend:5000
```

---

**Desarrollado por:** Ameth de Jesus Mendez Toledo  
**Proyecto:** Microservicios con Docker Compose  
**Fecha:** 2025
